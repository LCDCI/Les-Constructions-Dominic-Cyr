@startuml
hide circle
top to bottom direction

scale 0.4
!define ENTITY(entityName) class entityName << Entity >>
!define AGGREGATE_ROOT(aggregateRootName) class aggregateRootName << Aggregate Root >>
!define VALUE_OBJECT(valueObjectName) class valueObjectName << Value Object >>
!define ENUM(enumName) class enumName << Enum >>
!define AGGREGATE(aggregateName) class aggregateName << Aggregate >>
!pragma useVerticalIf on
skinparam dpi 350
skinparam packageStyle rectangle
skinparam rectangle {
    BackgroundColor #f7f4eb
    BorderColor Black
}

rectangle "Users Subdomain" as UserManagementContext #LightBlue {
    
    package "User Management Context" #F5F5F5 {
        ENTITY(Users) #lightpink {
            userIdentifier: UserIdentifier
            firstName: String
            lastName: String
            primaryEmail: String
            secondaryEmail: String
            phone: String
            userRole: UserRole
            auth0UserId: String
            userStatus: UserStatus
        }

        VALUE_OBJECT(UserIdentifier) #Bisque {
            userId: UUID
        }

        ENUM(UserRole) {
            OWNER
            SALESPERSON
            CONTRACTOR
            CUSTOMER
        }

        ENUM(UserStatus) {
            ACTIVE
            INACTIVE
            DEACTIVATED
        }

        'Users relationships'
        UserIdentifier "1" <-- "1" Users
        Users "1" *-- "1" UserRole
        Users "1" *-- "1" UserStatus
    }
}

rectangle "Project Subdomain" as ProjectManagementContext #LightGreen {
    
    package "Project Core Context" #F5F5F5 {
        AGGREGATE_ROOT(Project) #lightpink {
            projectId: Long
            projectIdentifier: String
            projectName: String
            projectDescription: String
            status: ProjectStatus
            startDate: LocalDate
            endDate: LocalDate
            completionDate: LocalDate
            primaryColor: String
            tertiaryColor: String
            buyerColor: String
            buyerName: String
            imageIdentifier: String
            customerId: String
            lotIdentifiers: List<String>
            progressPercentage: Integer
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
            contractorIds: List<String>
            salespersonIds: List<String>
            location: String
        }

        ENTITY(ProjectActivityLog) #lightpink {
            id: Long
            projectIdentifier: String
            activityType: ActivityType
            userIdentifier: String
            userName: String
            changedBy: String
            changedByName: String
            timestamp: LocalDateTime
            description: String
        }

        ENUM(ProjectStatus) {
            PLANNED
            IN_PROGRESS
            COMPLETED
            DELAYED
            CANCELLED
            ARCHIVED
        }

        ENUM(ActivityType) {
            CONTRACTOR_ASSIGNED
            CONTRACTOR_REMOVED
            SALESPERSON_ASSIGNED
            SALESPERSON_REMOVED
            CUSTOMER_ASSIGNED
            CUSTOMER_REMOVED
            PROJECT_CREATED
            PROJECT_UPDATED
            PROJECT_COMPLETED
        }
    }

    package "Schedule Management Context" #F5F5F5 {
        ENTITY(Schedule) #lightpink {
            id: Integer
            scheduleIdentifier: String
            scheduleStartDate: LocalDate
            scheduleEndDate: LocalDate
            scheduleDescription: String
            lotId: String
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        ENTITY(Task) #lightpink {
            id: Integer
            taskIdentifier: TaskIdentifier
            taskStatus: TaskStatus
            taskTitle: String
            periodStart: LocalDate
            periodEnd: LocalDate
            taskDescription: String
            taskPriority: TaskPriority
            estimatedHours: Double
            hoursSpent: Double
            taskProgress: Double
            scheduleId: String
        }

        VALUE_OBJECT(TaskIdentifier) #Bisque {
            taskId: UUID
        }

        ENUM(TaskStatus) {
            TO_DO
            IN_PROGRESS
            COMPLETED
            ON_HOLD
            CANCELLED
        }

        ENUM(TaskPriority) {
            VERY_LOW
            LOW
            MEDIUM
            HIGH
            VERY_HIGH
        }
    }

    package "Lot Management Context" #F5F5F5 {
        ENTITY(Lot) #lightpink {
            id: Integer
            lotIdentifier: LotIdentifier
            lotNumber: String
            civicAddress: String
            price: Float
            dimensionsSquareFeet: String
            dimensionsSquareMeters: String
            lotStatus: LotStatus
            createdAt: LocalDateTime
            remainingUpcomingWork: Integer
        }

        ENTITY(LotDocument) #lightpink {
            id: UUID
            uploaderName: String
            originalFileName: String
            storageKey: String
            mimeType: String
            sizeBytes: Long
            isImage: Boolean
            uploadedAt: LocalDateTime
        }

        VALUE_OBJECT(LotIdentifier) #Bisque {
            lotIdentifier: UUID
        }

        ENUM(LotStatus) {
            AVAILABLE
            SOLD
            PENDING
            RESERVED
        }
    }

    package "Quote Management Context" #F5F5F5 {
        ENTITY(Quote) #lightpink {
            quoteId: Long
            quoteNumber: String
            projectIdentifier: String
            lotIdentifier: UUID
            category: String
            contractorId: String
            totalAmount: BigDecimal
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        ENTITY(QuoteLineItem) #lightpink {
            lineItemId: Long
            itemDescription: String
            quantity: BigDecimal
            rate: BigDecimal
            lineTotal: BigDecimal
            displayOrder: Integer
        }
    }

    package "Portfolio Context" #F5F5F5 {
        ENTITY(Realization) #lightpink {
            id: Integer
            realizationIdentifier: RealizationIdentifier
            realizationName: String
            location: String
            description: String
            imageIdentifier: String
            numberOfRooms: Integer
            numberOfBedrooms: Integer
            numberOfBathrooms: Integer
            constructionYear: Integer
        }

        ENTITY(Renovation) #lightpink {
            id: Integer
            renovationIdentifier: RenovationIdentifier
            beforeImageIdentifier: String
            afterImageIdentifier: String
            description: String
        }

        VALUE_OBJECT(RealizationIdentifier) #Bisque {
            realizationIdentifier: UUID
        }

        VALUE_OBJECT(RenovationIdentifier) #Bisque {
            renovationIdentifier: UUID
        }
    }

    package "Content Management Context" #F5F5F5 {
        ENTITY(ProjectOverviewContent) #lightpink {
            id: Long
            projectIdentifier: String
            heroTitle: String
            heroSubtitle: String
            heroDescription: String
            overviewSectionTitle: String
            overviewSectionContent: String
            featuresSectionTitle: String
            locationSectionTitle: String
            locationDescription: String
            locationAddress: String
            locationMapEmbedUrl: String
            gallerySectionTitle: String
            locationLatitude: Double
            locationLongitude: Double
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        ENTITY(ProjectGalleryImage) #lightpink {
            id: Long
            projectIdentifier: String
            imageIdentifier: String
            imageCaption: String
            displayOrder: Integer
            createdAt: LocalDateTime
        }

        ENTITY(ProjectFeature) #lightpink {
            id: Long
            projectIdentifier: String
            featureTitle: String
            featureDescription: String
            displayOrder: Integer
            createdAt: LocalDateTime
        }

        ENTITY(ProjectManagementPageContent) #lightpink {
            id: Long
            language: String
            contentJson: String
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }
    }

    package "Living Environment Context" #F5F5F5 {
        ENTITY(LivingEnvironmentContent) #lightpink {
            id: Long
            projectIdentifier: String
            language: String
            headerTitle: String
            headerSubtitle: String
            headerSubtitleLast: String
            headerTagline: String
            descriptionText: String
            proximityTitle: String
            footerText: String
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        ENTITY(LivingEnvironmentAmenity) #lightpink {
            id: Long
            amenityKey: String
            amenityLabel: String
            displayOrder: Integer
        }
    }

    package "Shared Types" #F5F5F5 {
        ENUM(ImageType) {
            PNG
            JPEG
            WEBP
            HEIC
            BLOB
        }

        ENUM(DocumentType) {
            PDF
            DOCX
            TXT
            XLSX
        }
    }

    'Project Relationships'
    Project "1" *-- "1" ProjectStatus
    Project "1" --> "0..*" Schedule
    Schedule "1" --> "0..*" Task
    Schedule "1" --> "1" Project
    Task "1" *-- "1" TaskIdentifier
    Task "1" *-- "1" TaskStatus
    Task "1" *-- "1" TaskPriority
    Task "1" --> "0..1" UserIdentifier
    TaskIdentifier "1" <-- "1" Task
    
    Project "1" --> "0..*" Lot
    Lot "1" *-- "1" LotIdentifier
    Lot "1" *-- "1" LotStatus
    Lot "1" --> "1" Project
    Lot "1" --> "0..*" UserIdentifier
    LotIdentifier "1" <-- "1" Lot
    
    Quote "1" --> "1..*" QuoteLineItem
    QuoteLineItem "1" --> "1" Quote
    Quote "1" --> "0..1" LotIdentifier
    Quote "1" --> "1" UserIdentifier
    
    Realization "1" *-- "1" RealizationIdentifier
    RealizationIdentifier "1" <-- "1" Realization
    
    Renovation "1" *-- "1" RenovationIdentifier
    RenovationIdentifier "1" <-- "1" Renovation
    
    ProjectOverviewContent "1" --> "0..*" ProjectGalleryImage
    ProjectOverviewContent "1" --> "0..*" ProjectFeature
    
    LivingEnvironmentContent "1" --> "0..*" LivingEnvironmentAmenity
    LivingEnvironmentAmenity "1" --> "1" LivingEnvironmentContent
    
    LotDocument "1" --> "1" Lot
    LotDocument "1" --> "1" UserIdentifier
    
    ProjectActivityLog "1" *-- "1" ActivityType
}


rectangle "Communication Subdomain" as CommunicationContext #YellowGreen {
    
    package "Notification Context" #F5F5F5 {
        ENTITY(Notification) #lightpink {
            notificationId: UUID
            userId: UUID
            title: String
            message: String
            category: NotificationCategory
            link: String
            isRead: Boolean
            createdAt: LocalDateTime
        }

        ENUM(NotificationCategory) {
            TASK_ASSIGNED
            TASK_COMPLETED
            TASK_UPDATED
            PROJECT_CREATED
            PROJECT_UPDATED
            PROJECT_COMPLETED
            FORM_SUBMITTED
            FORM_SIGNED
            FORM_REJECTED
            SCHEDULE_CREATED
            SCHEDULE_UPDATED
            DOCUMENT_UPLOADED
            DOCUMENT_SHARED
            TEAM_MEMBER_ASSIGNED
            TEAM_MEMBER_REMOVED
            QUOTE_SUBMITTED
            QUOTE_APPROVED
            QUOTE_REJECTED
            INQUIRY_RECEIVED
            GENERAL
        }

        ENUM(NotificationType) {
            EMAIL
            SYSTEM_ALERT
        }
    }

    package "Inquiry Context" #F5F5F5 {
        ENTITY(Inquiry) #lightpink {
            id: Long
            name: String
            email: String
            phone: String
            message: String
            createdAt: OffsetDateTime
        }
    }

    'Notification Relationships'
    Notification "1" *-- "1" NotificationCategory
    Notification "1" --> "1" UserIdentifier
}

rectangle "Report Subdomain" as ReportContext #Khaki {
    
    package "Analytics Context" #F5F5F5 {
        ENTITY(AnalyticsReport) #lightpink {
            id: UUID
            ownerId: String
            reportType: String
            fileFormat: String
            fileKey: String
            fileSize: Long
            generationTimestamp: LocalDateTime
            startDate: LocalDateTime
            endDate: LocalDateTime
            status: String
            metadata: Map<String Object>
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        'Report Relationships'
        AnalyticsReport "1" --> "1" UserIdentifier
    }
}

rectangle "Form Subdomain" as FormContext #Lavender {
    
    package "Form Management Context" #F5F5F5 {
        AGGREGATE_ROOT(Form) #lightpink {
            id: Long
            formIdentifier: FormIdentifier
            formType: FormType
            formStatus: FormStatus
            projectIdentifier: String
            lotIdentifier: UUID
            customerId: UUID
            customerName: String
            customerEmail: String
            assignedByUserId: UUID
            assignedByName: String
            formTitle: String
            instructions: String
            formData: Map<String Object>
            assignedDate: LocalDateTime
            firstSubmittedDate: LocalDateTime
            lastSubmittedDate: LocalDateTime
            reopenedDate: LocalDateTime
            reopenCount: Integer
            createdAt: LocalDateTime
            updatedAt: LocalDateTime
        }

        ENTITY(FormSubmissionHistory) #lightpink {
            id: Long
            formIdentifier: String
            submissionNumber: Integer
            statusAtSubmission: FormStatus
            formDataSnapshot: Map<String Object>
            submittedByCustomerId: UUID
            submittedByCustomerName: String
            submittedAt: LocalDateTime
        }

        VALUE_OBJECT(FormIdentifier) #Bisque {
            formId: String
        }

        ENUM(FormType) {
            EXTERIOR_DOORS
            GARAGE_DOORS
            WINDOWS
            PAINT
            FLOORING
            KITCHEN
            BATHROOM
            ELECTRICAL
            PLUMBING
            OTHER
        }

        ENUM(FormStatus) {
            DRAFT
            ASSIGNED
            SUBMITTED
            REVIEWED
            APPROVED
            REJECTED
            REOPENED
            COMPLETED
        }
    }

    'Form Relationships'
    Form "1" *-- "1" FormIdentifier
    Form "1" *-- "1" FormType
    Form "1" *-- "1" FormStatus
    Form "1" --> "1" UserIdentifier : customerId
    Form "1" --> "1" UserIdentifier : assignedByUserId
    Form "1" --> "1" LotIdentifier : lotIdentifier
    Form "1" --> "0..*" FormSubmissionHistory
    FormSubmissionHistory "*" --> "1" Form
    FormIdentifier "1" <-- "1" Form
}

@enduml